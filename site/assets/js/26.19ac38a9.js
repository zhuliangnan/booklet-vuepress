(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{529:function(a,s,t){"use strict";t.r(s);var e=t(7),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"docker时间与linux不一致"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker时间与linux不一致"}},[a._v("#")]),a._v(" Docker时间与linux不一致")]),a._v(" "),t("h2",{attrs:{id:"_1-docker时间与linux不一致-java项目获取时间也不对"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-docker时间与linux不一致-java项目获取时间也不对"}},[a._v("#")]),a._v(" 1.Docker时间与linux不一致，java项目获取时间也不对")]),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v("老板：这个项目需要部署一下")]),a._v(" "),t("p",[a._v("我：妥\n。。。。一顿操作猛如虎")]),a._v(" "),t("p",[a._v("上传jar->创建Dockerfile->打镜像->启动")]),a._v(" "),t("p",[a._v("。。。。一个星期后")]),a._v(" "),t("p",[a._v("同事：你的代码取到的时间怎么不对")]),a._v(" "),t("p",[a._v("还是不慌 查一下系统时间date 进入容器再看一下docker时间，果然不一致")]),a._v(" "),t("p",[a._v("不慌不忙百度一下")])]),a._v(" "),t("p",[a._v("两种解决方案\n1.启动时使用-v挂载本地时间")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("docker run -ti -d --name 容器名字 -v /etc/localtime:/etc/localtime:ro  镜像名字  /bin/bash\n")])])]),t("p",[a._v("2.复制主机的localtime")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" /etc/localtime 容器ID:/etc/localtime\ndocker restart 容器ID\n")])])]),t("p",[a._v("可能会报错")]),a._v(" "),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[a._v("WARNING")]),a._v(" "),t("p",[a._v('Error response from daemon: Error processing tar file(exit status 1): invalid symlink "/etc/localtime" -> "../usr/share/zoneinfo/Asia/Shanghai"')])]),a._v(" "),t("p",[a._v("成功解决")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" /usr/share/zoneinfo/Asia/Shanghai 容器ID:/etc/localtime\ndocker restart 容器ID\n")])])]),t("p",[a._v("在确认一下linux和容器的时间")]),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v("我：已妥\n同事：ok\n。。。。。两小时后\n同事：还是不对\n我：眉毛一皱，不太妙\n百度，Google起来")])]),a._v(" "),t("p",[a._v("问题原因：jre是通过/etc/timezone 配置文件读取本地时间的\n接着我修改了/etc/timezone配置命令如下：")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("docker "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" -it 容器ID "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Asia/Shanghai"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /etc/timezone\ndocker restart 容器ID\n")])])]),t("p",[a._v("重启了下容器，然后java项目中读取的时区恢复正常了")])])}),[],!1,null,null,null);s.default=r.exports}}]);