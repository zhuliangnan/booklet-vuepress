(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{536:function(s,e,n){"use strict";n.r(e);var a=n(7),t=Object(a.a)({},(function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"docker配置redis自启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker配置redis自启动"}},[s._v("#")]),s._v(" Docker配置Redis自启动")]),s._v(" "),n("h3",{attrs:{id:"_1-获取redis镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-获取redis镜像"}},[s._v("#")]),s._v(" 1.获取redis镜像")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#获取redis镜像")]),s._v("\n\ndocker pull redis\n\n指定版本号：\n\ndocker pull redis:4.0.9\n不加版本号默认获取最新版本，也可以使用 docker search redis 查看镜像来源\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看本地镜像 ")]),s._v("\ndocker images\n")])])]),n("h3",{attrs:{id:"_2-启动容器-做映射"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-启动容器-做映射"}},[s._v("#")]),s._v(" 2.启动容器，做映射")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("①创建配置文件目录存放redis.conf，文件从官网下载。\n\n \n②创建文件夹,新建配置文件贴入从官网下载的配置文件并修改\nhttp://download.redis.io/redis-stable/redis.conf\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/local/docker\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /usr/local/docker/redis.conf\n\n \n③修改启动默认配置"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("从上至下依次"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("：\n\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#注释掉这部分，这是限制redis只能本地访问")]),s._v("\n\nprotected-mode no "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#默认yes，开启保护模式，限制为本地访问")]),s._v("\n\ndaemonize no"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#默认no，改为yes意为以守护进程方式启动，可后台运行，除非kill进程，改为yes会使配置文件方式启动redis失败")]),s._v("\n\ndatabases "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据库个数（可选），我修改了这个只是查看是否生效。。")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v("  ./ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#输入本地redis数据库存放文件夹（可选）")]),s._v("\n\nappendonly "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#redis持久化（可选）")]),s._v("\n\n")])])]),n("h3",{attrs:{id:"_3-docker启动redis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-docker启动redis"}},[s._v("#")]),s._v(" 3.docker启动redis")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker启动redis命令")]),s._v("\n\ndocker run -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 --name myredis -v /usr/local/docker/redis.conf:/etc/redis/redis.conf -v /usr/local/docker/data:/data -d redis redis-server /etc/redis/redis.conf --appendonly "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\nhttps://www.cnblogs.com/conswin/p/11547120.html\n\n命令解释说明：\n\n-p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 端口映射：前表示主机部分，：后表示容器部分。\n\n--name myredis  指定该容器名称，查看和进行操作都比较方便。\n\n-v 挂载目录，规则与端口映射相同。\n\n为什么需要挂载目录：个人认为docker是个沙箱隔离级别的容器，这个是它的特点及安全机制，不能随便访问外部（主机）资源目录，所以需要这个挂载目录机制。\n\n-d redis 表示后台启动redis\n\nredis-server /etc/redis/redis.conf  以配置文件启动redis，加载容器内的conf文件，最终找到的是挂载的目录/usr/local/docker/redis.conf\n\n\n--appendonly "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("  开启redis 持久化\n\n")])])]),n("h3",{attrs:{id:"_4-结果"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-结果"}},[s._v("#")]),s._v(" 4.结果")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看是否运行成功")]),s._v("\n\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" 查看运行的容器\ndockers logs myredis/27ddba64faa6  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("容器名称/id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])])])}),[],!1,null,null,null);e.default=t.exports}}]);